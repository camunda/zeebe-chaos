<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Resiliency against ELS unavailability | Zeebe Chaos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Resiliency against ELS unavailability | Zeebe Chaos"><meta data-rh="true" name="description" content="Due to recent initiatives and architecture changes, we coupled us even more against the secondary storage (often Elasticsearch, but can also be OpenSearch or in the future RDBMS)."><meta data-rh="true" property="og:description" content="Due to recent initiatives and architecture changes, we coupled us even more against the secondary storage (often Elasticsearch, but can also be OpenSearch or in the future RDBMS)."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-08-26T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ChrisKujawa"><meta data-rh="true" property="article:tag" content="availability"><link data-rh="true" rel="icon" href="/zeebe-chaos/img/zeebe-logo.png"><link data-rh="true" rel="canonical" href="https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability"><link data-rh="true" rel="alternate" href="https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability" hreflang="en"><link data-rh="true" rel="alternate" href="https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability","mainEntityOfPage":"https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability","url":"https://camunda.github.io/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability","headline":"Resiliency against ELS unavailability","name":"Resiliency against ELS unavailability","description":"Due to recent initiatives and architecture changes, we coupled us even more against the secondary storage (often Elasticsearch, but can also be OpenSearch or in the future RDBMS).","datePublished":"2025-08-26T00:00:00.000Z","author":{"@type":"Person","name":"Christopher Kujawa","description":"Principal Software Engineer @ Camunda","url":"https://github.com/ChrisKujawa","image":"https://github.com/ChrisKujawa.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://camunda.github.io/zeebe-chaos/","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/zeebe-chaos/rss.xml" title="Zeebe Chaos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zeebe-chaos/atom.xml" title="Zeebe Chaos Atom Feed"><link rel="stylesheet" href="/zeebe-chaos/assets/css/styles.ca109a4b.css">
<script src="/zeebe-chaos/assets/js/runtime~main.9ded5b43.js" defer="defer"></script>
<script src="/zeebe-chaos/assets/js/main.6b64b571.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/zeebe-chaos/img/zeebe-logo.png"><link rel="preload" as="image" href="https://github.com/ChrisKujawa.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zeebe-chaos/"><div class="navbar__logo"><img src="/zeebe-chaos/img/zeebe-logo.png" alt="Zeebe" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zeebe-chaos/img/zeebe-logo.png" alt="Zeebe" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Zeebe Chaos</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zeebe-chaos/">Chaos Summaries</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/camunda/zeebe-chaos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2026/01/08/Experimenting-with-data-availability-metric">Experimenting with data availability metric</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/12/11/Building-Confidence-at-Scale:-How-Camunda-Ensures-Platform-Reliability-Through-Continuous-Testing">Building Confidence at Scale: How Camunda Ensures Platform Reliability Through Continuous Testing</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/11/27/Stress-testing-Camunda">Stress testing Camunda</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/10/31/Improvents-in-retention">Testing retention of historical PIs in Camunda 8.8</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/10/02/Dynamic-Scaling-Resilience">Resilience of dynamic scaling</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/09/18/REST-API-From-ForkJoin-to-a-Dedicated-Thread-Pool">REST API: From ForkJoin to a Dedicated Thread Pool</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/zeebe-chaos/2025/08/26/Resiliency-against-ELS-unavailability">Resiliency against ELS unavailability</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/07/11/linear-dynamic-scaling">Dynamic Scaling: probing linear scalability</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/07/02/Follow-up-REST-API-performance">Follow up REST API performance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/06/30/Performance-of-REST-API">Performance of REST API</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/06/12/How-does-Zeebe-behave-with-NFS">How does Zeebe behave with NFS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2025/06/05/Lower-memory-consumption-of-Camunda-deployment">Lower memory consumption of Camunda deployment</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/12/12/News-from-Camunda-Exporter-project">News from Camunda Exporter project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/11/14/Impact-of-Camunda-Exporter-on-processing-performance">Impact of Camunda Exporter on processing performance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/10/24/Camunda-Exporter-MVP">Camunda Exporter MVP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/10/14/Optimizing-cluster-sizing-using-a-real-world-benchmark">Optimizing cluster sizing using a real world benchmark</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/08/19/Operate-improve-import-latency">Improve Operate import latency</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/08/16/Operate-load-handling">Operate load handling</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/07/25/Using-flow-control-to-handle-bottlenecked-exporting">Using flow control to handle bottleneck on exporting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/07/25/Using-flow-control-to-handle-uncontrolled-process-loops">Using flow control to handle uncontrolled process loops</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2024/01/19/Job-Activation-Latency">Reducing the job activation delay</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/12/20/Broker-scaling-performance">Broker Scaling and Performance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/12/19/Dynamic-Scaling-with-Dataloss">Dynamic Scaling with Dataloss</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/12/18/Dynamically-scaling-brokers">Dynamically scaling brokers</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/12/06/Job-Push-resiliency">Job push resiliency</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/11/30/Job-push-overloading">Job push overloading</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/11/07/Hot-backups-impact-on-processing">Hot backups impact on processing</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/06/02/Using-Large-Multi-Instance">Using Large Multi-Instance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/05/19/Continuing-SST-Partitioning-toggle">Continuing SST Partitioning toggle</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/05/15/SST-Partitioning-toggle">SST Partitioning toggle</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/04/06/gateway-termination">Gateway Termination</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2023/02/23/Recursive-call-activity">Recursive call activity</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2022/08/31/Message-Correlation-after-Network-Partition">Message Correlation after Network Partition</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2022/08/02/deployment-distribution">Bring Deployment distribution experiment back</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2022/02/15/Standalone-Gateway-in-CCSaaS">Standalone Gateway in CCSaaS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2022/02/01/High-Snapshot-Frequency">High Snapshot Frequency</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2022/01/19/big-variables">Handling of Big Variables</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/11/24/Worker-count-should-not-impact-performance">Worker count should not impact performance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/11/11/Not-produce-duplicate-Keys">Not produce duplicate Keys</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/10/29/Throughput-on-big-state">Throughput on big state</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/10/05/recovery-time">Recovery (Fail Over) time</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/09/23/Old-Clients">Old-Clients</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/07/06/Slow-Network">Slow Network</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/06/08/Full-Disk">Full Disk Recovery</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/05/25/Reset-Clock">Time travel Experiment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/04/29/Corrupted-Snapshot">Corrupted Snapshot Experiment Investigation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/04/03/bpmn-meets-chaos-engineering">BPMN meets Chaos Engineering</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/03/30/set-file-immutable">Set file immutable</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/03/23/camunda-cloud-network-partition">Camunda Cloud network partition</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/03/09/cont-workflow-instance">Fault-tolerant processing of process instances</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/02/23/automate-deployments-dist">Automating Deployment Distribution Chaos Experiment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/01/26/deployments">Deployment Distribution</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/01/19/network-partition">Network partitions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2021/01/07/disconnect-leader-and-follower">Disconnect Leader and one Follower</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2020</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/11/24/message-correlation-after-failover">Message Correlation after Failover</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/11/11/job-timeouts">Many Job Timeouts</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/11/03/investigate-failing-tests">Investigate failing Chaos Tests</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/10/20/non-graceful-shutdown">Non-graceful Shutdown Broker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/10/27/standalone-gw-memory">Gateway memory consumption</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/10/13/multiple-leader-changes">Multiple Leader Changes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/10/06/toxi-proxy">Play around with ToxiProxy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/08/20/experiment-with-camunda-cloud">Experiment with Camunda Cloud</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/08/06/low-load">Experiment with Low Load</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/07/30/experiment-without-exporters">Experiment without Exporters</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/07/16/big-multi-instance">Big Multi Instance</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/07/09/timer-and-huge-variables">Experiment with Timers and Huge Variables</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/07/02/extract-k8-resources">Extract K8 resources from namespace</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/06/25/gateway-network-partition">Gateway Network Partition</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/06/18/correlate-message-after-failover">Correlate Message after failover</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/06/11/high-cpu-gateway">High CPU load on Standalone Gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zeebe-chaos/2020/06/04/first-chaos-day">First Chaos Day!</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Resiliency against ELS unavailability</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-08-26T00:00:00.000Z">August 26, 2025</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/zeebe-chaos/authors/zell"><img class="avatar__photo authorImage_XqGP" src="https://github.com/ChrisKujawa.png" alt="Christopher Kujawa"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/zeebe-chaos/authors/zell"><span class="authorName_yefp" translate="no">Christopher Kujawa</span></a></div><small class="authorTitle_nd0D" title="Principal Software Engineer @ Camunda">Principal Software Engineer @ Camunda</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Due to recent initiatives and architecture changes, we coupled us even more against the secondary storage (often Elasticsearch, but can also be OpenSearch or in the future RDBMS).</p>
<p>We now have one single application to run Webapps, Gateway, Broker, Exporters, etc., together. Including the new Camunda Exporter exporting all necessary data to the secondary storage. On bootstrap we need to create an expected schema, so our components work as expected, allowing Operate and Tasklist Web apps to consume the data and the exporter to export correctly. Furthermore, we have a new query API (REST API) allowing the search for available data in the secondary storage.</p>
<p>We have seen in previous experiments and load tests that unavailable ELS and not properly configured replicas can cause issues like the exporter not catching up or queries not succeeding. See related <a href="https://github.com/camunda/camunda/issues/35080" target="_blank" rel="noopener noreferrer" class="">GitHub issue</a>.</p>
<p>In todays chaos day, we want to play around with the replicas setting of the indices, which can be set in the Camunda Exporter (which is in charge of writing the data to the secondary storage).</p>
<p><strong>TL;DR;</strong> Without the index replicas set, the Camunda Exporter is directly impacted by ELS node restarts. The query API seem to handle this transparently, but changing the resulting data. Having the replicas set will cause some performance impact, as the ELS node might run into CPU throttling (as they have much more to do). ELS slowing down has an impact on processing as well due to our write throttling mechanics. This means we need to be careful with this setting, while it gives us better availability (CamundaExporter can continue when ELS nodes restart), it might come with some cost.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="chaos-experiment">Chaos Experiment<a href="#chaos-experiment" class="hash-link" aria-label="Direct link to Chaos Experiment" title="Direct link to Chaos Experiment" translate="no">​</a></h2>
<p>In the following, we want to experiment with the following:</p>
<ol>
<li class="">We restart the first Elasticsearch node and observe how the CamundaExporter performs.</li>
<li class="">We restart the Elasticsearch node that is primary for a certain index, and use the query API.</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="expected">Expected<a href="#expected" class="hash-link" aria-label="Direct link to Expected" title="Direct link to Expected" translate="no">​</a></h3>
<p>With the index replica set to more than zero in the Camunda Exporter, the Exporter and Query API should be able to work properly even if one ELS node goes down. In our base set up we expect it to fail.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="actual">Actual<a href="#actual" class="hash-link" aria-label="Direct link to Actual" title="Direct link to Actual" translate="no">​</a></h3>
<p>We will set up a base load test, having the default configuration, and some increasing the replicas to compare with.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="base">Base<a href="#base" class="hash-link" aria-label="Direct link to Base" title="Direct link to Base" translate="no">​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-up">Set up<a href="#set-up" class="hash-link" aria-label="Direct link to Set up" title="Direct link to Set up" translate="no">​</a></h5>
<p>Creating the default load test by simply running our <a href="https://github.com/camunda/camunda/actions/workflows/zeebe-benchmark.yml" target="_blank" rel="noopener noreferrer" class="">benchmark GitHub action</a>. By default, the load tests install Elasticsearch with three nodes.</p>
<p><img decoding="async" loading="lazy" alt="base-es" src="/zeebe-chaos/assets/images/base-indices-fb488f288f5b3b11d2b92929a04216c2.png" width="1889" height="512" class="img_ev3q"></p>
<p>We can see that the indices have only one primary shard, but no replication.</p>
<p>The system is working as expected with the normal load.</p>
<p><img decoding="async" loading="lazy" alt="base" src="/zeebe-chaos/assets/images/base-ed163f3cbe7cffc95bc08f46dc5b83d9.png" width="1898" height="759" class="img_ev3q"></p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="restart-first-node">Restart first node<a href="#restart-first-node" class="hash-link" aria-label="Direct link to Restart first node" title="Direct link to Restart first node" translate="no">​</a></h5>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ k delete pod elastic-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-0&quot; deleted</span><br></span></code></pre></div></div>
<p>As soon as the Elasticsearch pod was restarted, the cluster reacted with backpressure. The decrease of exporting was detected, causing to throttle the writing. We can see the cluster load metric, which spiked. Having a direct impact of the processing performance.</p>
<p><img decoding="async" loading="lazy" alt="base-restart" src="/zeebe-chaos/assets/images/base-es-restart-ad2897e5b77f38f2307906ef0f72f28e.png" width="1865" height="925" class="img_ev3q"></p>
<p>As soon as the Elasticsearch pod recovers and comes back the cluster and processing can recover as well.</p>
<p><img decoding="async" loading="lazy" alt="base-recover" src="/zeebe-chaos/assets/images/base-recover-54ceaa944fb473bb3856ba21aca7604b.png" width="1882" height="768" class="img_ev3q"></p>
<h6 class="anchor anchorTargetStickyNavbar_Vzrq" id="restart-primary">Restart primary<a href="#restart-primary" class="hash-link" aria-label="Direct link to Restart primary" title="Direct link to Restart primary" translate="no">​</a></h6>
<p>Looking at the nodes and the index distributions, we can, for example, see that Node 1 is the primary of the flow node instance index.</p>
<p><img decoding="async" loading="lazy" alt="base-primary" src="/zeebe-chaos/assets/images/base-primary-node-236505e9bb3fc5fbf7b322ef319ab880.png" width="1892" height="572" class="img_ev3q"></p>
<p><strong>Querying for flownode instances:</strong></p>
<p>First, we have to port-forward to our Camunda instance.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">k port-forward svc/camunda 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from 127.0.0.1:8080 -&gt; 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from [::1]:8080 -&gt; 8080</span><br></span></code></pre></div></div>
<p>Search flow node instances following the <a href="https://docs.camunda.io/docs/next/apis-tools/operate-api/specifications/search-4/" target="_blank" rel="noopener noreferrer" class="">documentation </a>, we can copy the cURL command (removing the Authorization header as we don&#x27;t need it with our current installation):</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -H &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -H &#x27;Accept: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;filter&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;key&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;processInstanceKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;processDefinitionKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;startDate&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;endDate&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;flowNodeId&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;flowNodeName&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;incidentKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;UNSPECIFIED&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;state&quot;: &quot;ACTIVE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;incident&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;tenantId&quot;: &quot;string&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;searchAfter&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;sort&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;field&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;order&quot;: &quot;ASC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;status&quot;:400,&quot;message&quot;:&quot;Sort has invalid field(s): string&quot;,&quot;instance&quot;:&quot;f5ddf702-7ad6-4a05-af9a-9112f2436706&quot;,&quot;type&quot;:&quot;Data invalid&quot;}</span><br></span></code></pre></div></div>
<p>Seems to cause some issues with the sorting. Removing this and setting the size to 1 (as this was another failure returned), we run into:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;filter&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;key&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;processInstanceKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;processDefinitionKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;startDate&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;endDate&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;flowNodeId&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;flowNodeName&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;incidentKey&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;UNSPECIFIED&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;state&quot;: &quot;ACTIVE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;incident&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;tenantId&quot;: &quot;string&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;status&quot;:500,&quot;message&quot;:&quot;Error in reading flownode instances&quot;,&quot;instance&quot;:&quot;a50c501e-161c-42fb-bac1-dc71416580d7&quot;,&quot;type&quot;:&quot;API application error&quot;}</span><br></span></code></pre></div></div>
<p>Not clear what the issue is. Removing the filters and just setting size, returns us something.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799817981066,&quot;processInstanceKey&quot;:2251799817981049,&quot;processDefinitionKey&quot;:2251799813685298,&quot;startDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;flowNodeId&quot;:&quot;start&quot;,&quot;flowNodeName&quot;:&quot;start&quot;,&quot;type&quot;:&quot;START_EVENT&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799817981066],&quot;total&quot;:10000}</span><br></span></code></pre></div></div>
<p>Now going ahead and restarting Elasticsearch node 1.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ k delete pod elastic-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-1&quot; deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799817981066,&quot;processInstanceKey&quot;:2251799817981049,&quot;processDefinitionKey&quot;:2251799813685298,&quot;startDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;flowNodeId&quot;:&quot;start&quot;,&quot;flowNodeName&quot;:&quot;start&quot;,&quot;type&quot;:&quot;START_EVENT&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799817981066],&quot;total&quot;:10000}</span><br></span></code></pre></div></div>
<p>The restart seem to be rather quick and had no real impact on the query API. Checking the primary distribution again, we realized that actually <code>elastic-2</code> is the primary of the historic indices.</p>
<p><img decoding="async" loading="lazy" alt="real-primary" src="/zeebe-chaos/assets/images/base-real-primary-a8803e45780a06090f24bfb10bf0ae26.png" width="1861" height="447" class="img_ev3q"></p>
<p>Doing it again, we can also observe that the historic index is unassinged at this time.</p>
<p><img decoding="async" loading="lazy" alt="base-unassigned" src="/zeebe-chaos/assets/images/base-unassigned-77da751ad273ae1199740eda922d5374.png" width="1365" height="527" class="img_ev3q"></p>
<p>Interestingly, is that we are not seeing any error from the query API. We still return some data.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799818189380,&quot;processInstanceKey&quot;:2251799818189363,&quot;processDefinitionKey&quot;:2251799813685298,&quot;startDate&quot;:&quot;2025-08-26T12:16:09.754+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T12:16:09.754+0000&quot;,&quot;flowNodeId&quot;:&quot;start&quot;,&quot;flowNodeName&quot;:&quot;start&quot;,&quot;type&quot;:&quot;START_EVENT&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799818189380],&quot;total&quot;:10000}</span><br></span></code></pre></div></div>
<p>To better understand this, we introduce some sorting based on the key.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1, &quot;sort&quot;: [ { &quot;field&quot;: &quot;key&quot; } ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799817981066,&quot;processInstanceKey&quot;:2251799817981049,&quot;processDefinitionKey&quot;:2251799813685298,&quot;startDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T12:13:23.156+0000&quot;,&quot;flowNodeId&quot;:&quot;start&quot;,&quot;flowNodeName&quot;:&quot;start&quot;,&quot;type&quot;:&quot;START_EVENT&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799817981066,2251799817981066],&quot;total&quot;:10000}</span><br></span></code></pre></div></div>
<p>We can see the returned FNI has the key <code>2251799817981066</code>. If we now remove the primary of the historic indices (elastic-2).</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> k delete pod elastic-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-2&quot; deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cqjawa (No connection:-) ~/(main)]$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1, &quot;sort&quot;: [ { &quot;field&quot;: &quot;key&quot; } ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799818301951,&quot;processInstanceKey&quot;:2251799818301934,&quot;processDefinitionKey&quot;:2251799813685298,&quot;startDate&quot;:&quot;2025-08-26T12:18:43.362+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T12:18:43.362+0000&quot;,&quot;flowNodeId&quot;:&quot;start&quot;,&quot;flowNodeName&quot;:&quot;start&quot;,&quot;type&quot;:&quot;START_EVENT&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799818301951,2251799818301951],&quot;total&quot;:9916}</span><br></span></code></pre></div></div>
<p>We retrieve <code>2251799818301951</code> which is likely in the runtime index, an instance that haven&#x27;t been archived yet.</p>
<p>The Query API is handling the Elasticsearch availability transparently, by returning different results (likely this depends on the filter criteria). Something we (and users) should be aware.</p>
<p>Just for the sake of completeness, I tested with restarting <code>elastic-1</code> and <code>elastic-2</code> and run the same query.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ k delete pod elastic-2 elastic-1 &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1] 201244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-2&quot; deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-1&quot; deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1, &quot;sort&quot;: [ { &quot;field&quot;: &quot;key&quot; } ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;status&quot;:500,&quot;message&quot;:&quot;Error in reading flownode instances&quot;,&quot;instance&quot;:&quot;1fa0c323-082f-4a9f-99d1-01208ecccbd5&quot;,&quot;type&quot;:&quot;API application error&quot;}</span><br></span></code></pre></div></div>
<p>The error handling should be improved to better indicate the current issue.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="one-replica">One replica<a href="#one-replica" class="hash-link" aria-label="Direct link to One replica" title="Direct link to One replica" translate="no">​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-up-1">Set up<a href="#set-up-1" class="hash-link" aria-label="Direct link to Set up" title="Direct link to Set up" translate="no">​</a></h5>
<p>Setting: <code>--set zeebe.config.zeebe.broker.exporters.CamundaExporter.args.index.numberOfReplicas=1</code> should allow us to configure the CamundaExporter to create indices with one replica (instead of zero as per default).</p>
<p>Deploying a configmap with:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   zeebe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      broker:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exporters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          CamundaExporter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              index:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                numberOfReplicas: 1</span><br></span></code></pre></div></div>
<p>This seems to have no affect.</p>
<p><img decoding="async" loading="lazy" alt="index-no-replica" src="/zeebe-chaos/assets/images/index-no-replica-5873c8adb1df0ede02e6b3077177e75b.png" width="1615" height="373" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="index-template-no-replica" src="/zeebe-chaos/assets/images/index-template-no-replica-c532ee73879d60f5d0606ad5a775eea4.png" width="716" height="503" class="img_ev3q"></p>
<p>The reason is that the config has been moved to: <code>camunda.database.index.numberOfReplicas</code> (in the current SNAPSHOT). After changing the configuration (and restarting the pods), the indices settings are updated.</p>
<p><img decoding="async" loading="lazy" alt="replicas" src="/zeebe-chaos/assets/images/replicas-aa3d363cf1f342d90d903cc4191b3f1e.png" width="1750" height="738" class="img_ev3q"></p>
<p>Generally, the performance of the cluster seem to be highly affected.</p>
<p><img decoding="async" loading="lazy" alt="one-replica-general" src="/zeebe-chaos/assets/images/one-replica-general-c770f4309d357321f892db752892f549.png" width="1865" height="775" class="img_ev3q"></p>
<p>Looking at the CPU usage, we can see the Elasticsearch CPU went from around 1 core to almost 2. The throttling is around 60%, which likely impacts the performance a lot.</p>
<p><img decoding="async" loading="lazy" alt="cpu" src="/zeebe-chaos/assets/images/one-replica-cpu-52f7a96748e7a13040ffa776ce93d1ae.png" width="1883" height="690" class="img_ev3q"></p>
<p>In comparison to the base.</p>
<p><img decoding="async" loading="lazy" alt="base-cpu" src="/zeebe-chaos/assets/images/base-cpu-e9471092c25276fa5f003225ca538ef8.png" width="1884" height="690" class="img_ev3q"></p>
<p>I think in general it is not suprising, as the ES nodes need to do more (replicating), but something we should be aware of when rolling it out.</p>
<p>This means enabling the replicas can highly impact the system performance, and likely need some resource adjustments (not only disk space).</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="restart-first-node-1">Restart first node<a href="#restart-first-node-1" class="hash-link" aria-label="Direct link to Restart first node" title="Direct link to Restart first node" translate="no">​</a></h5>
<p>Even though the performance is already impacted, we should see less impact when restarting the first node, so we will continue with the experimentation for now.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ k delete pod elastic-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-0&quot; deleted</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="one-replica-impact" src="/zeebe-chaos/assets/images/one-replica-impact-c19aa064cc4536e3207e757643e8bac8.png" width="1874" height="764" class="img_ev3q"></p>
<p>When restarting the first node, we can see that &quot;only&quot; one partition seems to be affected. But due to the limit of resources on the nodes and already existing CPU throttling, this also impacts other nodes. Causing our cluster load going up, and backpressure in consequence.</p>
<p>Compared to the base, we still can see some difference, as it was before it impacted all partitions.</p>
<p><img decoding="async" loading="lazy" alt="base-impact" src="/zeebe-chaos/assets/images/base-impact-8f8d5a3058d6f2f9ecf417c167f14627.png" width="1878" height="458" class="img_ev3q"></p>
<p>It might be interesting to do the experiment again, with increased resources.</p>
<h6 class="anchor anchorTargetStickyNavbar_Vzrq" id="restart-primary-1">Restart primary<a href="#restart-primary-1" class="hash-link" aria-label="Direct link to Restart primary" title="Direct link to Restart primary" translate="no">​</a></h6>
<p>When we check the index-node distribution, we can see the replicas as well.</p>
<p><img decoding="async" loading="lazy" alt="one-replica-distribution" src="/zeebe-chaos/assets/images/one-replica-distribution-f7ace01da14896d626e105bf0427e0a9.png" width="1905" height="524" class="img_ev3q"></p>
<p>We have already seen in our base that the query API still works when one of the historic or runtime indices is available.</p>
<p>Interesting would be now, if we still return the same result, even when we restart the primary of the historic index.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1, &quot;sort&quot;: [ { &quot;field&quot;: &quot;key&quot; } ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799813772120,&quot;processInstanceKey&quot;:2251799813772101,&quot;processDefinitionKey&quot;:2251799813685252,&quot;startDate&quot;:&quot;2025-08-26T11:22:09.083+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T11:22:12.640+0000&quot;,&quot;flowNodeId&quot;:&quot;task&quot;,&quot;flowNodeName&quot;:&quot;task&quot;,&quot;type&quot;:&quot;SERVICE_TASK&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799813772120,2251799813772120],&quot;total&quot;:10000}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ k delete pod elastic-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod &quot;elastic-0&quot; deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -L &#x27;http://localhost:8080/v1/flownode-instances/search&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Accept: application/json&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;size&quot;: 1, &quot;sort&quot;: [ { &quot;field&quot;: &quot;key&quot; } ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;items&quot;:[{&quot;key&quot;:2251799813772120,&quot;processInstanceKey&quot;:2251799813772101,&quot;processDefinitionKey&quot;:2251799813685252,&quot;startDate&quot;:&quot;2025-08-26T11:22:09.083+0000&quot;,&quot;endDate&quot;:&quot;2025-08-26T11:22:12.640+0000&quot;,&quot;flowNodeId&quot;:&quot;task&quot;,&quot;flowNodeName&quot;:&quot;task&quot;,&quot;type&quot;:&quot;SERVICE_TASK&quot;,&quot;state&quot;:&quot;COMPLETED&quot;,&quot;incident&quot;:false,&quot;tenantId&quot;:&quot;&lt;default&gt;&quot;}],&quot;sortValues&quot;:[2251799813772120,2251799813772120],&quot;total&quot;:10000}</span><br></span></code></pre></div></div>
<p>As expected, the results are the same (as we have a replica).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="result">Result<a href="#result" class="hash-link" aria-label="Direct link to Result" title="Direct link to Result" translate="no">​</a></h2>
<p>When running the experiment against the base, we were not expecting that the Query API handles ES unavailability until a certain point. The error messaging needs to be improved here if there is actually a problem, like a wrong filter or no index available.</p>
<p>Enabling the replicas was harder than expected, as we are currently in the process of changing our configuration (unified configuration). After finding the right properties (thanks to Houssain), we were even able to update an existing installation.</p>
<p>The replicas setting has an unforeseen performance impact; we expected disk space increase in our past discussions, but not how it impacts the general performance. It should be considered when rolling it out by default.</p>
<p>Having this setting allows to better handle ELS unavailability, especially for the Query API. When enough resources, likely also for the Camunda Exporter, this should be re-tested.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="observations">Observations<a href="#observations" class="hash-link" aria-label="Direct link to Observations" title="Direct link to Observations" translate="no">​</a></h3>
<ul>
<li class="">Query API handles ELS unavailability transparently; we should clarify whether this is expected</li>
<li class="">Query API returns useless errors when the needed indices are not available or when the given filter doesn&#x27;t work</li>
<li class="">The Query API documentation is not easy to start with - we should give a command that can be easily tried out</li>
<li class="">Replicas setting has an impact on cluster performance - as ELS can run in CPU throttling, causing slow in general processing (due to write throttling).</li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/zeebe-chaos/tags/availability">availability</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/camunda/zeebe-chaos/blob/master/chaos-days/blog/2025-08-26-Resiliency-against-ELS-unavailability/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/zeebe-chaos/2025/09/18/REST-API-From-ForkJoin-to-a-Dedicated-Thread-Pool"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">REST API: From ForkJoin to a Dedicated Thread Pool</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zeebe-chaos/2025/07/11/linear-dynamic-scaling"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Dynamic Scaling: probing linear scalability</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#chaos-experiment" class="table-of-contents__link toc-highlight">Chaos Experiment</a><ul><li><a href="#expected" class="table-of-contents__link toc-highlight">Expected</a></li><li><a href="#actual" class="table-of-contents__link toc-highlight">Actual</a></li></ul></li><li><a href="#result" class="table-of-contents__link toc-highlight">Result</a><ul><li><a href="#observations" class="table-of-contents__link toc-highlight">Observations</a></li></ul></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/zeebe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://forum.camunda.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/Camunda" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/camunda/zeebe-chaos/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Zeebe Chaos. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>